import{_ as a,c as s,o as n,N as e}from"./chunks/framework.a5f3ff40.js";const u=JSON.parse('{"title":"PVE 中虚机磁盘扩容","description":"","frontmatter":{},"headers":[],"relativePath":"virtualization/pve-磁盘扩容.md"}'),l={name:"virtualization/pve-磁盘扩容.md"},p=e(`<h1 id="pve-中虚机磁盘扩容" tabindex="-1">PVE 中虚机磁盘扩容 <a class="header-anchor" href="#pve-中虚机磁盘扩容" aria-label="Permalink to &quot;PVE 中虚机磁盘扩容&quot;">​</a></h1><h2 id="磁盘扩容" tabindex="-1">磁盘扩容 <a class="header-anchor" href="#磁盘扩容" aria-label="Permalink to &quot;磁盘扩容&quot;">​</a></h2><blockquote><p>进入系统，查看磁盘使用量</p></blockquote><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">df -h</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291513023.png" alt=""></p><blockquote><p>查看磁盘类型</p></blockquote><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">lsblk</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291514176.png" alt=""></p><blockquote><p>根据磁盘类型扩容，目前机器上只挂载了两种，lvm和disk类型</p></blockquote><h2 id="lvm-磁盘扩容" tabindex="-1">lvm 磁盘扩容 <a class="header-anchor" href="#lvm-磁盘扩容" aria-label="Permalink to &quot;lvm 磁盘扩容&quot;">​</a></h2><blockquote><p>例如图中，我们要对根目录扩容</p></blockquote><h3 id="登录并打开pve管理页面-增加磁盘容量" tabindex="-1">登录并打开pve管理页面，增加磁盘容量 <a class="header-anchor" href="#登录并打开pve管理页面-增加磁盘容量" aria-label="Permalink to &quot;登录并打开pve管理页面，增加磁盘容量&quot;">​</a></h3><blockquote><p>首先查看是否有多余空间, Disks -&gt; LVM-Thin</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291515008.png" alt=""></p><blockquote><p>进入控制台对应虚拟机页面， 虚拟机 -&gt; Hardware</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291516738.png" alt=""></p><blockquote><p>选中对应Hard Disk条目 点击 Resize Disk，下图中演示的是增加10G(实际情况要根据业务调整大小值)，点击Resize disk</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291516255.png" alt=""></p><blockquote><p>通过命令可以看到对应磁盘已经增加，但是还没有增加到指定分区</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291516288.png" alt=""></p><h3 id="虚拟机中扩容" tabindex="-1">虚拟机中扩容 <a class="header-anchor" href="#虚拟机中扩容" aria-label="Permalink to &quot;虚拟机中扩容&quot;">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">fdisk /dev/sda</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291517554.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#再次查看，出现sda4</span></span>
<span class="line"><span style="color:#A6ACCD;">lsblk -l</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291517619.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#创建pv</span></span>
<span class="line"><span style="color:#A6ACCD;">pvcreate /dev/sda4</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291517103.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#将/dev/sda4 加入ubuntu-vg vg中</span></span>
<span class="line"><span style="color:#A6ACCD;">vgextend ubuntu-vg /dev/sda4</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291517587.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#可以看到新加硬盘在ubuntu-vg 中</span></span>
<span class="line"><span style="color:#A6ACCD;">pvdisplay</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291518818.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#扩容lvm，将剩余空间都给 / 路径</span></span>
<span class="line"><span style="color:#A6ACCD;">lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291518466.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#刷新 / 路径所在文件系统</span></span>
<span class="line"><span style="color:#A6ACCD;">resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291519765.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#再次查看，扩容已完成</span></span>
<span class="line"><span style="color:#A6ACCD;">df -h</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291519748.png" alt=""></p><h2 id="disk-磁盘扩容" tabindex="-1">disk 磁盘扩容 <a class="header-anchor" href="#disk-磁盘扩容" aria-label="Permalink to &quot;disk 磁盘扩容&quot;">​</a></h2><blockquote><p>对disk /dev/sdb扩容</p></blockquote><h3 id="pve中操作" tabindex="-1">pve中操作 <a class="header-anchor" href="#pve中操作" aria-label="Permalink to &quot;pve中操作&quot;">​</a></h3><blockquote><p>选中对应Hard Disk条目 点击 Resize Disk，下图中演示的是增加20G(实际情况要根据业务调整大小值)，点击Resize disk</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291519165.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291519947.png" alt=""></p><h3 id="虚拟机中操作扩容" tabindex="-1">虚拟机中操作扩容 <a class="header-anchor" href="#虚拟机中操作扩容" aria-label="Permalink to &quot;虚拟机中操作扩容&quot;">​</a></h3><blockquote><p>通过命令可以看到对应磁盘已经增加，但是还没有增加到指定分区</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291520114.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#刷新 /home/jinzong 路径所在文件系统</span></span>
<span class="line"><span style="color:#A6ACCD;">xfs_growfs /home/jinzong</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291520448.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">#再次查看，扩容已完成</span></span>
<span class="line"><span style="color:#A6ACCD;">df -h</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/callac/markdown-image@main/img/202402291520730.png" alt=""></p>`,50),t=[p];function i(c,o,r,d,g,m){return n(),s("div",null,t)}const C=a(l,[["render",i]]);export{u as __pageData,C as default};
